[15:29:14][DEBUG](com.nucco.beans.User) - { CALL PG_AUTH.LOGIN (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
[15:29:14][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:29:15][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:29:20][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:29:20][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[15:29:24][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[15:29:24][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:29:44][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:29:44][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:29:44][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[15:29:44][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:29:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:29:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:29:59][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:29:59][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210301' AND '20210331' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210301', -5) AND F_GET_WORKDAY@VANBT('20210331', -5) ) A WHERE YYYYMMDD BETWEEN '20210301' AND '20210331' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:30:00][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:30:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:30:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:30:02][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:30:03][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:30:03][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[15:30:03][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:30:03][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:30:03][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:31:21][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:31:21][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210101' AND '20210331' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210101', -5) AND F_GET_WORKDAY@VANBT('20210331', -5) ) A WHERE YYYYMMDD BETWEEN '20210101' AND '20210331' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:31:22][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:31:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:31:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:32:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:32:12][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210401' AND '20210431' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210401', -5) AND F_GET_WORKDAY@VANBT('20210431', -5) ) A WHERE YYYYMMDD BETWEEN '20210401' AND '20210431' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:32:13][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:32:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:32:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:32:20][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:32:20][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20200201' AND '20200231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20200201', -5) AND F_GET_WORKDAY@VANBT('20200231', -5) ) A WHERE YYYYMMDD BETWEEN '20200201' AND '20200231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:32:22][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[15:32:22][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:32:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:32:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:36:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:36:09][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20200401' AND '20200431' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20200401', -5) AND F_GET_WORKDAY@VANBT('20200431', -5) ) A WHERE YYYYMMDD BETWEEN '20200401' AND '20200431' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:36:10][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[15:36:10][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:36:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:36:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[15:36:24][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:36:25][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20200301' AND '20200331' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20200301', -5) AND F_GET_WORKDAY@VANBT('20200331', -5) ) A WHERE YYYYMMDD BETWEEN '20200301' AND '20200331' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:36:27][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:36:27][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[15:36:27][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:03:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:03:12][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:03:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:03:17][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:03:33][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:03:33][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ SUBSTR(TRANSACTION_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(TRANSACTION_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210201' AND '20210231' ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:03:34][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:03:34][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:03:34][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:04:00][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:04:00][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:04:00][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:04:00][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:04:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:04:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:05:47][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:05:47][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:05:52][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:05:52][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:06:04][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:06:05][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:06:05][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:06:05][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:06:05][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:06:05][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:09:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:09:10][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:09:15][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:09:15][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:09:23][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:09:24][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:09:24][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:09:24][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:09:24][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:09:24][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:13][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:13][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:14][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:10:14][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:14][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:14][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:16][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:16][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:16][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:10:16][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:16][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:16][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:41][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:41][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:41][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:10:41][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:41][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:41][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:44][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:44][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:44][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:10:44][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:46][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:46][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:47][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:10:47][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:49][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:49][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:49][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:10:49][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:49][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:49][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:10:58][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:58][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:59][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:10:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:11:28][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:28][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:11:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:11:31][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:31][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:31][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:31][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:11:31][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:11:56][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:57][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:57][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:11:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:11:59][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:59][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:59][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:11:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:12:02][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:12:02][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:12:02][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:12:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:12:03][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:12:23][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:12:23][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:12:23][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:12:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:12:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:12:24][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:12:25][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20211201' AND '20211231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20211201', -5) AND F_GET_WORKDAY@VANBT('20211231', -5) ) A WHERE YYYYMMDD BETWEEN '20211201' AND '20211231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:12:25][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:12:25][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:12:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:12:30][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:12:30][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:12:31][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:12:31][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:12:31][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:12:31][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:14:28][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:14:28][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:14:28][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:14:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:14:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:14:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:14:30][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:14:30][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:14:30][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:14:30][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:14:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:14:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:14:33][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:14:33][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:14:33][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:14:33][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:14:33][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:14:33][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:15:14][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:15:15][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:15:15][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:15:15][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:15:15][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:15:15][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:15:18][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:15:18][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:15:19][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:15:19][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:15:19][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:15:19][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:00][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:00][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:00][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:00][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:07][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:07][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:07][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:07][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:07][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:07][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:23][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:23][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:23][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:23][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:25][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:26][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:26][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:26][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:28][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:28][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:28][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:39][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:40][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:40][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:40][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:40][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:40][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:16:44][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:16:44][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:16:44][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:16:44][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:16:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:16:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:17:01][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:01][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:17:01][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:17:01][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:17:01][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:17:01][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:17:06][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:07][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:17:07][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:17:07][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:17:07][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:17:07][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:17:08][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:08][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:17:08][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:17:08][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:17:08][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:17:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:17:10][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:10][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:17:11][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:17:11][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:17:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:17:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:07][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:08][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:08][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:08][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:08][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:08][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:10][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:10][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:10][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:11][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:11][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:11][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:11][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:13][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:13][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:13][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:25][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:26][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:26][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:26][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:27][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:28][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:28][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:44][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:44][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:45][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:45][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:46][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:46][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:47][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:47][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:55][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:55][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:56][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:56][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:56][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:56][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:56][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:57][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:57][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:57][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:18:57][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:18:58][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:18:58][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:18:58][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:18:58][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:18:58][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:19:07][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:07][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:19:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:19:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:50][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:50][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:19:50][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:19:50][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:19:50][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:19:50][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:19:52][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:52][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:19:52][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:19:52][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:19:52][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:19:52][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:19:53][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:54][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:19:54][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:19:54][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:19:54][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:19:54][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:19:58][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:59][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:19:59][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:19:59][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:19:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:19:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:20:00][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:20:00][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:20:00][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:20:00][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:20:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:20:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:04][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:04][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:05][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:21:05][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:05][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:05][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:06][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:07][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:07][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:21:07][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:07][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:07][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:08][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:09][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:09][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:21:09][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:10][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:10][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:10][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:21:10][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:12][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210231' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210231', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210231' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:12][ERROR](com.nucco.beans.Sales) - java.sql.SQLDataException: ORA-01839: 지정된 월에 대한 날짜가 부적합합니다
ORA-06512: "VANBT.F_GET_WORKDAY",  21행
ORA-06512:  1행

[16:21:12][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:44][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:45][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210228' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210228', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210228' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:45][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:47][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:47][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210228' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210228', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210228' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:47][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:21:48][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:49][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210228' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210228', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210228' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:49][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:49][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:21:49][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:22:27][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:22:28][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210228' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210228', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210228' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:22:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:22:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:22:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:22:29][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:22:29][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210201' AND '20210228' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210201', -5) AND F_GET_WORKDAY@VANBT('20210228', -5) ) A WHERE YYYYMMDD BETWEEN '20210201' AND '20210228' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:22:30][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:22:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:22:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
[16:22:35][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:22:36][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_DATE) */ SUBSTR(PAY_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE PAY_DATE BETWEEN '20210401' AND '20210430' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' GROUP BY SUBSTR(PAY_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ F_GET_WORKDAY@VANBT(CANCEL_DATE, 5) AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND PAY_DATE IS NOT NULL AND A.COMPANY_SEQ = 861 AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN F_GET_WORKDAY@VANBT('20210401', -5) AND F_GET_WORKDAY@VANBT('20210430', -5) ) A WHERE YYYYMMDD BETWEEN '20210401' AND '20210430' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:22:36][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 861 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:22:36][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '03'
[16:22:36][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 861
