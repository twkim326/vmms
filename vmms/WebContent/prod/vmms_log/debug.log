[15:48:10][DEBUG](com.nucco.beans.User) - { CALL PG_AUTH.LOGIN (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
[15:48:10][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:11][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:15][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:15][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[15:48:16][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[15:48:16][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:33][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:33][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_CARD' AND CODE <> '000' ORDER BY CODE
[15:48:33][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ TRANSACTION_DATE AS YYYYMMDD, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN 1 END) AS CNT_PREPAY_CSB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_CSB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN 1 END) AS CNT_PREPAY_KRP, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_KRP, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN 1 END) AS CNT_PREPAY_MYB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_MYB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN 1 END) AS CNT_PREPAY_TMN, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_TMN, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY TRANSACTION_DATE, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT YYYYMMDD, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN 1 END) AS CNT_PREPAY_CSB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_CSB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN 1 END) AS CNT_PREPAY_KRP, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_KRP, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN 1 END) AS CNT_PREPAY_MYB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_MYB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN 1 END) AS CNT_PREPAY_TMN, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_TMN, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY YYYYMMDD, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMMDD DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:48:34][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:48:34][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:48:34][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:48:34][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:48:57][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210829' AND '20210829' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND A.PAY_TYPE <> '09' AND PAY_STEP NOT IN ('00', '99')
[15:48:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210829' AND '20210829' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND A.PAY_TYPE <> '09' AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[15:48:57][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[15:48:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[15:48:59][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:48:59][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_CARD' AND CODE <> '000' ORDER BY CODE
[15:48:59][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ TRANSACTION_DATE AS YYYYMMDD, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN 1 END) AS CNT_PREPAY_CSB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_CSB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN 1 END) AS CNT_PREPAY_KRP, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_KRP, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN 1 END) AS CNT_PREPAY_MYB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_MYB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN 1 END) AS CNT_PREPAY_TMN, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN AMOUNT END), 0) AS AMOUNT_PREPAY_TMN, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY TRANSACTION_DATE, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT YYYYMMDD, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN 1 END) AS CNT_PREPAY_CSB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'CSB' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_CSB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN 1 END) AS CNT_PREPAY_KRP, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'KRP' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_KRP, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN 1 END) AS CNT_PREPAY_MYB, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'MYB' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_MYB, COUNT(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN 1 END) AS CNT_PREPAY_TMN, NVL(SUM(CASE WHEN PAY_TYPE = '11' AND PAY_CARD = 'TMN' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY_TMN, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY YYYYMMDD, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMMDD DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:49:00][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:49:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:49:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:49:00][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:49:35][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:49:35][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:49:35][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:49:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:49:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:49:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:49:37][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:49:37][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[15:49:38][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[15:49:38][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[15:49:38][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[15:51:04][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:51:04][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:51:04][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:51:04][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:51:04][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:51:04][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:54:39][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:54:39][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN -1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN -1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN -1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN -1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:54:39][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:54:39][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:54:39][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:54:40][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:54:50][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:54:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[15:54:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[15:54:51][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[15:54:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[15:54:53][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:54:53][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN -1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN -1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN -1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN -1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:54:53][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:54:53][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:54:53][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:54:53][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:55:02][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:55:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[15:55:03][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[15:55:03][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[15:55:03][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[15:55:36][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:55:37][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN -1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN -1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN -1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN -1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:55:37][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:55:37][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:55:37][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:55:37][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:55:40][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:55:40][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[15:55:41][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[15:55:41][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:55:53][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:55:53][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN -1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN -1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN -1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN -1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:55:54][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:55:54][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:55:54][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:55:54][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:55:57][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:55:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND A.PAY_TYPE <> '09' AND PAY_STEP NOT IN ('00', '99')
[15:55:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND A.PAY_TYPE <> '09' AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[15:55:57][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[15:55:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[15:57:15][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:57:15][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[15:57:15][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[15:57:15][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[15:57:15][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[15:57:15][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[15:57:17][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[15:57:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND A.PAY_TYPE <> '09' AND PAY_STEP NOT IN ('00', '99')
[15:57:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND A.PAY_TYPE <> '09' AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[15:57:17][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[15:57:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT SEQ, NAME, IS_RAW_SALESCOUNT, ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NVL(MAX(DEPTH), 0) FROM TB_ORGANIZATION WHERE COMPANY_SEQ = A.SEQ ) AS DEPTH FROM TB_COMPANY A ORDER BY NAME
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:01:09][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:01:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ CODE, NAME FROM TB_CODE WHERE TYPE = 'PAY_TYPE' AND CODE <> '000' ORDER BY CODE
[16:01:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:27][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:28][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:01:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:01:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:01:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:01:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:01:54][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:01:54][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:01:55][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:01:55][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:01:55][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:01:55][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:02:43][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:02:43][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:02:43][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:02:43][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:02:43][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:02:47][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:02:47][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:02:47][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:02:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:02:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:02:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:03:27][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:03:27][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:03:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:03:28][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:03:28][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:03:35][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:03:35][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:03:35][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:03:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:03:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:03:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:03:38][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:03:38][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND A.PAY_TYPE <> '09' AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:03:39][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:03:39][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:03:39][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:03:39][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:03:45][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:04:13][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ SUBSTR(TRANSACTION_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY SUBSTR(TRANSACTION_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:04:13][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:04:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:04:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:04:13][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:04:25][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:04:25][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:04:26][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:04:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:04:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:04:26][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:04:57][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:04:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:04:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:04:57][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:04:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:05:50][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:05:50][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:05:51][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:05:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:05:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:05:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:09:47][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:09:47][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:09:47][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:09:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:09:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:09:47][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:10:43][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:10:43][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:10:43][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:10:43][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:10:43][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:10:43][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:11:02][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:02][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:02][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:11:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:11:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:11:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:12][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:12][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:11:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:11:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:11:55][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:11:55][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:11:56][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:11:56][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:11:56][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:11:56][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:12:45][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:12:45][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:12:45][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:12:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:12:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:12:45][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:13:01][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:13:01][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:13:02][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:13:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:13:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:13:02][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:13:04][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:13:05][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:13:06][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:13:06][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:13:06][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:13:06][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:13:09][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:13:10][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:13:10][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:13:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:13:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:13:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:17:32][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:32][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000011' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:17:32][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000011' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:17:32][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:17:32][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:17:46][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:46][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:17:46][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:17:46][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:17:46][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:17:46][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:17:48][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:48][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16495 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:17:48][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16495 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:17:48][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:17:48][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:17:50][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:50][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:17:50][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:17:50][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:17:50][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:17:50][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:17:51][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:17:51][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:17:52][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:17:52][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:17:52][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:19:11][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:19:11][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:19:11][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:19:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:19:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:19:11][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:20:10][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:20:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16495 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:20:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16495 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:20:10][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:20:10][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:20:12][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:20:12][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:20:12][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:20:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:20:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:20:12][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:20:13][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:20:14][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:20:14][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:20:14][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:20:14][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:21:19][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:21:19][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:21:19][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:21:19][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:21:19][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:21:19][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:30:04][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:30:04][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:30:05][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:30:05][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:30:05][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:30:16][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:30:16][DEBUG](com.nucco.beans.Sales) - SELECT DECODE(S.PAY_TYPE, '01', C.CARD_NO, '02', C.CARD_NO, '10', C.CARD_NO, '07', C.CARD_NO, '11', P.CARD_NO, '') CARD_NO, DECODE(S.PAY_TYPE, '01', C.PURCHASE_ORGAN_NAME, '02', '현금', '10', '현금', '07', C.PURCHASE_ORGAN_NAME, '11', DECODE(P.ORGAN_CODE, 'TMN', '티머니', 'CSB', '캐시비', 'MYB', '마이비', 'KRP', '레일플러스', '선불'), '카드') PURCHASE_ORGAN_NAME, DECODE(S.PAY_TYPE, '01', C.APPROVAL_NO, '02', C.APPROVAL_NO, '07', C.APPROVAL_NO, '') APPROVAL_NO, DECODE(S.PAY_TYPE, '01', C.TERMINAL_TRANS_SEQ, '02', C.TERMINAL_TRANS_SEQ, '10', C.TERMINAL_TRANS_SEQ, '07', C.TERMINAL_TRANS_SEQ, '11', P.TERMINAL_TRANS_SEQ) TERMINAL_TRANS_SEQ, NVL(S.CLOSING_DATE,'-') AS CLOSING_DATE FROM TB_SALES S LEFT OUTER JOIN TB_TXT_TRANSACTION_CREDIT C ON (S.TERMINAL_ID = C.TERMINAL_ID AND S.TRANSACTION_NO = C.TRANSACTION_NO) LEFT OUTER JOIN TB_TXT_TRANSACTION_PREPAY P ON (S.TERMINAL_ID = P.TERMINAL_ID AND S.TRANSACTION_NO = P.TRANSACTION_NO) WHERE S.TERMINAL_ID = '2000016119' AND S.TRANSACTION_NO = '210807173533771635' 
[16:30:21][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:30:21][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:30:22][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:30:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:30:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:30:22][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:30:35][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:30:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:30:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16494 AND PRODUCT_CODE = '00000019' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:30:35][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:30:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:30:44][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:30:44][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:30:44][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:30:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:30:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:30:44][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:30:48][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:30:48][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COUNT(*) FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16495 AND PRODUCT_CODE = '00000020' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99')
[16:30:48][DEBUG](com.nucco.beans.Sales) - SELECT /*+ ORDERED USE_NL(B C D E F G H I) */ A.TRANSACTION_DATE || A.TRANSACTION_TIME AS TRANSACTION_DATE, CASE WHEN A.CLOSING_DATE IS NOT NULL THEN A.CLOSING_DATE || NVL(A.CLOSING_TIME, '000000') END AS CLOSING_DATE, A.PURCHASE_DATE, CASE WHEN A.PAY_STEP = '02' THEN A.PAY_DATE_EXP ELSE A.PAY_DATE END AS PAY_DATE, CASE WHEN A.CANCEL_DATE IS NOT NULL THEN A.CANCEL_DATE || NVL(A.CANCEL_TIME, '000000') END AS CANCEL_DATE, A.TERMINAL_ID, A.TRANSACTION_NO, A.ITEM_COUNT, A.AMOUNT, A.COL_NO, B.NAME AS ORGAN, C.PLACE, NVL(D.NAME, '미등록 상품[' || A.COL_NO || ']') AS GOODS, E.CODE AS VM_CODE, F.NAME AS PAY_TYPE, G.NAME AS PAY_STEP, H.NAME AS INPUT_TYPE, I.NAME AS PAY_CARD FROM ( SELECT ROWNUM AS ROW_NUM, A.* FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ * FROM TB_SALES A WHERE A.TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND VM_PLACE_SEQ = 16495 AND PRODUCT_CODE = '00000020' AND PAY_TYPE IN ('01') AND PAY_STEP NOT IN ('00', '99') ORDER BY A.TRANSACTION_DATE DESC, A.TRANSACTION_TIME DESC ) A WHERE ROWNUM <= 30) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ LEFT JOIN TB_PRODUCT D ON A.COMPANY_SEQ = D.COMPANY_SEQ AND A.PRODUCT_CODE = D.CODE LEFT JOIN TB_VENDING_MACHINE E ON A.TERMINAL_ID = E.TERMINAL_ID LEFT JOIN TB_CODE F ON A.PAY_TYPE = F.CODE AND F.TYPE = 'PAY_TYPE' LEFT JOIN TB_CODE G ON A.PAY_STEP = G.CODE AND G.TYPE = 'PAY_STEP' LEFT JOIN TB_CODE H ON A.INPUT_TYPE = H.CODE AND H.TYPE = 'INPUT_TYPE' LEFT JOIN TB_CODE I ON A.PAY_CARD = I.CODE AND I.TYPE = 'PAY_CARD' WHERE A.ROW_NUM >= 1
[16:30:48][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC) WHERE ROWNUM = 1
[16:30:48][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ IS_VIEW_CLOSING FROM TB_COMPANY WHERE SEQ = 659
[16:31:00][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:31:01][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:31:01][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:31:01][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:31:01][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:31:01][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:32:39][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:32:40][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ SUBSTR(TRANSACTION_DATE, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY SUBSTR(TRANSACTION_DATE, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT SUBSTR(YYYYMMDD, 1, 6) AS YYYYMM, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY SUBSTR(YYYYMMDD, 1, 6), COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY YYYYMM DESC, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:32:40][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:32:40][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:32:40][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:32:40][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:32:56][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:32:56][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:32:57][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:32:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:32:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:32:57][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:33:16][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:33:17][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:33:17][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:33:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:33:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:33:17][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:33:22][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:33:22][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D E) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE, NVL(E.NAME, '미등록 상품[' || A.COL_NO || ']') AS PRODUCT,  E.CODE AS PRODUCT_CODE  FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, TERMINAL_ID, PRODUCT_CODE, COL_NO,  COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, TERMINAL_ID, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, TERMINAL_ID, PRODUCT_CODE, COL_NO,  COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, TERMINAL_ID, PRODUCT_CODE, COL_NO ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ LEFT OUTER JOIN TB_PRODUCT E  ON A.COMPANY_SEQ = E.COMPANY_SEQ  AND A.PRODUCT_CODE = E.CODE  ORDER BY ORGAN, PLACE, VM_CODE, COL_NO, A.AMOUNT_CARD DESC
[16:33:23][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:33:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:33:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:33:23][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:33:35][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:33:35][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:33:36][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:33:36][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:33:36][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:33:36][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:34:15][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:34:16][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:34:16][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:34:16][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:34:16][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:34:16][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:54:30][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:54:30][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ UNION ALL SELECT COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:54:30][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:54:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:54:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:54:30][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
[16:54:34][DEBUG](com.nucco.GlobalConfig) - { CALL PG_AUTH.MENU (?, ?, ?, ?) }
[16:54:34][DEBUG](com.nucco.beans.Sales) -  SELECT /*+ ORDERED USE_HASH(B C D) */ A.*, B.NAME AS ORGAN, B.CODE AS ORGAN_CODE, C.PLACE AS PLACE, D.CODE AS VM_CODE FROM ( SELECT AA.TYPE, AA.COMPANY_SEQ,  AA.ORGANIZATION_SEQ,  AA.VM_PLACE_SEQ,  AA.PRODUCT_CODE,  SUM(AA.CNT_CARD) CNT_CARD,  SUM(AA.AMOUNT_CARD) AMOUNT_CARD,  SUM(AA.CNT_PAYCO) CNT_PAYCO,  SUM(AA.AMOUNT_PAYCO) AMOUNT_PAYCO,  SUM(AA.CNT_ITEM) CNT_ITEM,  SUM(AA.AMOUNT_ITEM) AMOUNT_ITEM,  SUM(AA.CNT_CASH) CNT_CASH,  SUM(AA.AMOUNT_CASH) AMOUNT_CASH,  SUM(AA.CNT_PREPAY) CNT_PREPAY,  SUM(AA.AMOUNT_PREPAY) AMOUNT_PREPAY,  NVL(E.NAME, '미등록 상품[' ||  AA.COL_NO || ']') AS PRODUCT  FROM (	 SELECT /*+ INDEX(A IX_SALES_TRANSACTION_DATE) */ 'A' TYPE, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN AMOUNT END), 0) AS AMOUNT_PREPAY FROM TB_SALES A WHERE TRANSACTION_DATE BETWEEN '20210801' AND '20210831' AND PAY_STEP NOT IN ('00', '99') AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO UNION ALL SELECT 'C' TYPE, COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE,  COL_NO, COUNT(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN 1 END) AS CNT_CARD, NVL(SUM(CASE WHEN PAY_TYPE = '01' and pay_step <> '06' THEN -AMOUNT END), 0) AS AMOUNT_CARD, COUNT(CASE WHEN PAY_TYPE = '07' THEN 1 END) AS CNT_PAYCO, NVL(SUM(CASE WHEN PAY_TYPE = '07' THEN -AMOUNT END), 0) AS AMOUNT_PAYCO, COUNT(CASE WHEN PAY_TYPE = '80' THEN 1 END) AS CNT_ITEM, NVL(SUM(CASE WHEN PAY_TYPE = '80' THEN -AMOUNT END), 0) AS AMOUNT_ITEM, COUNT(CASE WHEN PAY_TYPE IN ('02', '10') THEN 1 END) AS CNT_CASH, NVL(SUM(CASE WHEN PAY_TYPE IN ('02', '10') THEN -AMOUNT END), 0) AS AMOUNT_CASH, COUNT(CASE WHEN PAY_TYPE = '11' THEN 1 END) AS CNT_PREPAY, NVL(SUM(CASE WHEN PAY_TYPE = '11' THEN -AMOUNT END), 0) AS AMOUNT_PREPAY FROM ( SELECT /*+ INDEX(A IX_SALES_PAY_STEP) */ CANCEL_DATE AS YYYYMMDD, A.* FROM TB_SALES A WHERE PAY_STEP = '29' AND TRANSACTION_DATE IS NOT NULL AND A.COMPANY_SEQ = 659 AND A.ORGANIZATION_SEQ IN ( SELECT /*+ INDEX(TB_ORGANIZATION) */ SEQ FROM TB_ORGANIZATION WHERE SORT = 1 START WITH COMPANY_SEQ = 659 AND SEQ IN ( SELECT 3211 FROM DUAL UNION SELECT /*+ INDEX(TB_USER_APP_ORGAN) */ ORGANIZATION_SEQ FROM TB_USER_APP_ORGAN WHERE SEQ = 1045 ) CONNECT BY PRIOR SEQ = PARENT_SEQ ) AND PAY_TYPE IN ('01') AND CANCEL_DATE BETWEEN '20210801' AND '20210831' ) A WHERE YYYYMMDD BETWEEN '20210801' AND '20210831' GROUP BY COMPANY_SEQ, ORGANIZATION_SEQ, VM_PLACE_SEQ, PRODUCT_CODE, COL_NO ) AA  LEFT OUTER JOIN TB_PRODUCT E ON AA.COMPANY_SEQ = E.COMPANY_SEQ AND AA.PRODUCT_CODE = E.CODE   GROUP BY AA.TYPE, AA.COMPANY_SEQ, AA.ORGANIZATION_SEQ, AA.VM_PLACE_SEQ, AA.PRODUCT_CODE, NVL(E.NAME, '미등록 상품[' || AA.COL_NO || ']')  ) A INNER JOIN TB_ORGANIZATION B ON A.ORGANIZATION_SEQ = B.SEQ INNER JOIN TB_VENDING_MACHINE_PLACE C ON A.VM_PLACE_SEQ = C.SEQ INNER JOIN TB_VENDING_MACHINE D ON C.VM_SEQ = D.SEQ ORDER BY PRODUCT, ORGAN, PLACE, VM_CODE, A.AMOUNT_CARD DESC
[16:54:35][DEBUG](com.nucco.beans.Sales) - SELECT NAME FROM ( SELECT /*+ INDEX(TB_ORGANIZATION) */ NAME FROM TB_ORGANIZATION WHERE COMPANY_SEQ = 659 AND SORT = 0 ORDER BY DEPTH DESC ) WHERE ROWNUM = 1
[16:54:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_CODE) */ NAME FROM TB_CODE WHERE TYPE = 'SUM_TYPE' AND CODE = '01'
[16:54:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_COMPANY) */ NAME FROM TB_COMPANY WHERE SEQ = 659
[16:54:35][DEBUG](com.nucco.beans.Sales) - SELECT /*+ INDEX(TB_ORGANIZATION) */ REVERSE(LTRIM(SYS_CONNECT_BY_PATH(REVERSE(NAME), '/'), '/')) FROM TB_ORGANIZATION WHERE PARENT_SEQ = 0 START WITH SEQ = 3211 CONNECT BY SEQ = PRIOR PARENT_SEQ
